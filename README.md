# NC Maternal Health Map
A web mapping application designed by [Quinn Keefer](https://keeferq.github.io/Portfolio/)

### I. Introduction

Access to maternal healthcare resources is a critical factor influencing maternal and infant health outcomes. North Carolina, like many states, faces challenges related to disparities in access and outcomes across different regions. This web mapping application aims to provide a visual tool for exploring the geographic distribution of maternal health providers alongside county-level fetal death rates within North Carolina.

The map displays fetal death rate data per county using a choropleth representation, allowing users to quickly identify areas with higher rates. Overlayed on this are the locations of known maternal health providers, visualized as points that cluster at lower zoom levels for clarity. A key feature of this application is the ability for users to search for any address within North Carolina and instantly see the calculated distance to the nearest mapped provider, offering insight into potential geographic barriers to access.

This tool integrates publicly available health statistics and provider location data into an interactive format. It is intended for use by the public to aid in understanding the spatial landscape of maternal health in North Carolina.

### II. Methodology

This interactive web map was developed using standard languages like HTML, CSS, JavaScript and leverages several client-side geospatial libraries to process and display data directly within the user's browser. The design incorporates principles of User Interface (UI) and User Experience (UX) design to facilitate intuitive exploration and information retrieval (Roth, 2017). The core functionalities, including data visualization, clustering, geocoding, and spatial analysis, are handled by the browser after initial data loading.

#### A. Data

The content of the web map is derived from the following data sources and types:

*   **County Fetal Death Rate Data:**
    *   Source: `https://schs.dph.ncdhhs.gov/data/databook/`.
    *   Description: This data file contains the fetal death rates per 1000 deliveries from 2019-2023. It was joined with a North Carolina shapefile and converted to a GeoJSON for display online. 
    *   Processing (In-App): The fill color of each county is determined by its `DeathRate` value, mapped through a color scale generated by `Chroma.js`.



*   **Maternal Health Provider Locations:**
    *   Source: `https://npiregistry.cms.hhs.gov/search`.
    *   Description: Utilizing the NPPES NPI registry healthcare providers that specialize in maternal health were selected by taxonomy codes(`207R00000X, 207Q00000X, 207V00000Xm, 208D00000X, 363L00000X, etc`) and downloaded
    *   Preprosessing: This data was geocoded for the entire US. To optimize and shrink the data so that it works in browser, North Carolina was selected and the data was filtered with a spatial intersect join. As the NPI dataset will contain each registered provider, a hosiptal could have hundreds, so to make the points easier to read they were grouped by address and the total count was recorded. This aggregation is not perfect as it requires case sensitive addresses to match but it significantly reduced the number of points (from 31,000 to 8,800). From here the data was converted into the GeoJSON format and exported. This preprocessing was done in RStudio 

    *   Processing (In-App): Loaded via JavaScript `fetch`. Rendered as markers using Leaflet. Markers are custom `L.divIcon` elements styled with Font Awesome icons. The size of each icon is dynamically scaled based on the `popup_count` property (number of providers at the same address) using the `getClinicIconSize` function to visually represent provider density at a location. Markers are added to a `L.markerClusterGroup` for performance and clarity at lower zoom levels. Popups are bound to each marker displaying the provider count. The raw feature data is stored globally (`clinicData`) for use in distance calculations.

*   **Base Map Tiles:**
    *   Source: CartoDB (Positron).
    *   Description: Provides geographic context (roads, labels, administrative boundaries).

*   **Address Geocoding Data:**
    *   Source: OpenStreetMap (via `Leaflet-GeoSearch` plugin and `OpenStreetMapProvider`).
    *   Description: Used to convert user-entered addresses into geographic coordinates (latitude, longitude).
    *   Processing (In-App): Accessed dynamically when a user performs a search via the GeoSearch control. Search results are prioritized for North Carolina using a bounding box (`ncViewBox`).

#### B. Medium for Delivery

The map is a web browser-based application designed to be accessible across various devices, including desktops, tablets, and mobile phones. Responsiveness is implemented via CSS media queries. All necessary code and data assets are loaded and processed client-side. 

The technology stack includes:
*   Core: HTML5, CSS3, JavaScript 
*   Mapping Library: Leaflet.js
*   Mapping Plugins:
    *   Leaflet.markercluster (for grouping provider markers)
    *   Leaflet-GeoSearch (for address search functionality)
*   Geospatial Analysis: Turf.js (for nearest point calculation and distance measurement)
*   Color Manipulation: Chroma.js (for creating the choropleth color scale)
*   Icons: Font Awesome (for provider and search result markers)

#### C. Application Layout

The application interface follows established UI design patterns for web maps, organizing controls spatially for intuitive access:
*   **Main Map Area:** Displays thematic data layers over the base map.
*   **Top Left Controls:** Map Title (provides context) and Zoom Controls (standard *affordances* for scale manipulation).
*   **Top Center Controls:** Address Search Bar (`Leaflet-GeoSearch`).
*   **Bottom Left Controls:** Information Button (ℹ️) which toggles a modal window (provides extended context without cluttering the main interface).
*   **Bottom Right Controls:** Map Legend (key for interpreting the choropleth) and Leaflet Attribution.
*   **Modal Window:** (`infoModalOverlay`) Provides background information, data sources, definitions, and usage instructions, supporting the overall user experience.


#### D. Thematic Representation

Data is visualized using several cartographic techniques, providing visual feedback to the user about the geographic patterns and results of interactions:

*   **Choropleth Map:** County polygons colored based on `DeathRate` using a `Chroma.js` sequential scheme (light orange to dark red), interpretable via the legend. `COUNTY_FILL_OPACITY` maintains base map visibility.
*   **Proportional Symbols (Size):** Provider icons scaled by `popup_count`, visually encoding provider density at a location.
*   **Clustered Point Symbols:** `Leaflet.markercluster` groups markers at lower zooms. Cluster icons provide numerical *feedback* on the number of contained markers.
*   **Point Markers:** Distinct markers for individual providers (at high zoom) and the address search result.
*   **Line Symbol:** A dashed `L.polyline` dynamically drawn as feedback connecting a searched address to the nearest provider, visualizing the result of the distance calculation

#### E. User Interaction

The *user experience (UX)* is centered around map exploration and targeted information retrieval, facilitated by several core *interaction operators* implemented using common *interface styles* (Roth, 2017):

*   **Standard Navigation:** Panning (`Pan` operator) and zooming (`Zoom` operator) are supported via *direct manipulation* of the map canvas (click-and-drag, scroll wheel) and dedicated UI buttons.
*   **Address Search:** The `Search` operator is implemented via a *form fill-in* interface style (the search bar). Selecting a result triggers map navigation and places a distinct marker, providing clear feedback.
*   **Nearest Provider Calculation:** This automated function enhances the UX by directly addressing a potential user goal (finding nearby care). Triggered by address search completion, it uses Turf.js (Calculate operator implicitly) and provides immediate visual feedback through the connecting line and a popup showing the calculated distance.
*   **Information Retrieval:** The `Retrieve` operator allows users to get details on demand. This is implemented via *direct manipulation* (clicking) on provider markers or clusters. Popups serve as *feedback*, displaying the provider count or enabling zoom-in on clusters.
*   **Contextual Help:** Clicking the info button (`Retrieve` operator on a UI element) toggles a modal window, providing access to supporting information without disrupting the primary map view.


#### F. Aesthetics and Design Considerations

Visual interface design choices aim to create a clear, usable, and aesthetically pleasing *user experience (UX)*:

*   **Basemap:** CartoDB Positron (light, minimalist) minimizes distraction.
*   **Color Palette:** Purposeful colors distinguish data layers (sequential orange-red for rates, distinct purple for providers, highlighted orange for search, blue for distance line).
*   **UI Styling:** Consistent styling of controls (white background, rounded corners, shadows) provides a cohesive look and feel, offering familiar visual *affordances*.
*   **Iconography:** Font Awesome icons provide clear visual cues for UI elements and map features.
*   **Typography:** Standard sans-serif fonts prioritize readability.
*   **Responsiveness:** CSS `@media` queries adapt layout and sizing for different screen dimensions, ensuring usability across devices.

### III. Conclusion

The NC Maternal Health Map provides a valuable tool for visualizing the intersection of maternal health outcomes (fetal death rates) and resource availability (provider locations) across North Carolina. By integrating spatial analysis features like address searching and nearest provider calculation, it offers insights into potential geographic disparities in access to care. This application serves as a starting point for further exploration and discussion regarding maternal health equity in the state. Future iterations could incorporate additional datasets, such as provider types, insurance acceptance, or socio-economic factors, to provide an even richer understanding of the complex factors influencing maternal health.

### IV. Discussion

There are several limitations of this approach, mainly the lack of distinction between providers care type (obgyn vs general practice). The nearest provider calculations left much to be desired as it fails to take into account any geographic variables or barriers. To create a better calculation a network analysis utilizing road networks would enable higher quality results.

But this project still provides a useful tool to understand how the providers are distributed and the relative proximity of them. 

---

### V. Sources
Roth RE, CM Sack, G Baldrica-Franklin, Y Chen, R Donohue, L Houtman, T Prestby, R Tolochko, and N Underwood. 2020. Web Mapping: A Workbook for Interactive Cartography and Visualization on the Open Web. Version 0.1. University of Wisconsin Cartography Laboratory: Madison, WI. DOI: 10.5281/zenodo.5565480

Roth, R. E. (2017). User Interface and User Experience (UI/UX) Design. The Geographic Information Science & Technology Body of Knowledge (2nd Quarter 2017 Edition), John P. Wilson (ed.). DOI: 10.22224/gistbok/2017.2.5.
